{"version":3,"sources":["write.js"],"names":["id","editor","getArticle","$","ajax","url","type","dataType","data","success","log","val","title","abstract","txt","html","newPassage","console","category","addCategory","dataSend","JSON","stringify","contentType","text","fadeIn","setTimeout","fadeOut","updatePassage","document","ready","wangEditor","E","uploadImgShowBase64","customConfig","location","window","indexOf","str","split","click"],"mappings":"aAIA,IAAIA,GAAGC,OA0BP,SAASC,WAAWD,EAAOD,GAA3BG,EAAAC,MACMA,IAAK,yBAAAJ,EACHK,KAAI,MACJC,SAAK,OACLC,QAAAA,SAHGC,GAIHC,IACOD,QAAME,IAAA,iBAEPP,EAAA,eAAAQ,IAAAH,EAAAI,OACET,EAAE,eAAeQ,IAAIH,EAAKI,UAC1BT,EAAE,eAAeQ,IAAIH,EAAKK,UAC1BV,EAAEW,IAAAC,KAAFP,EAAqBA,aAOrC,SAASQ,aAATC,QAASD,IAATf,OAAsBa,IAAAC,QACdE,IAAQP,EAAIT,EAAAA,eAAZU,MACIC,EAAUT,EAAA,eAAdQ,MACIO,EAAaf,EAAA,gBAAjBQ,MAKIH,GAAAA,MAAOI,EACPA,SALcT,EAAE,eAAgBQ,MAMhCE,QALaZ,OAAAa,IAAAC,QAGjBI,EAKGA,EAAAA,YAAaA,EAETX,EAAA,SAAAU,EAEN,IAAAE,EAAAC,KAAAC,UAAAd,GACGY,QAAAA,IAAWC,GACfJ,EAAAA,MACOZ,IAAA,qBACHA,KAAI,OACJC,KAAKc,EACLZ,YAHG,mBAIHe,QAAAA,SAAcf,GACdC,QAAQC,IAAAF,GACJS,EAAAA,WAAAO,KAAAhB,GACEL,EAAA,WAAFsB,SACEC,WAAWD,WACbC,EAAAA,WAAWC,UACLxB,EAAA,WAAWwB,KAAb,KACE,QAMtB,SAASC,gBAATX,QAASW,IAAAA,iBACLX,QAAQP,IAAI,QAAAV,IACZiB,IAAAA,EAAYd,EAAA,eAAZQ,MACIC,EAAUT,EAAA,eAAFQ,MACRO,EAAaf,EAAA,gBAAFQ,MACXQ,EAAAA,EAAAA,eAAgBR,MAChBE,EAAAA,OAAaC,IAAAC,OAGbP,GAAAA,GAAAA,GACAR,MADOY,EAEPA,SAAOA,EACPC,QAAAA,GAHJM,EAMGA,EAAAA,YAAaA,EAAhBX,EAAA,SAEOU,EAEN,IAAAE,EAAAC,KAAAC,UAAAd,GACDS,QAAIG,IAAAA,GACJH,EAAAA,MACEb,IAAK,wBACHC,KAAI,OACJC,KAAAA,EACAE,YAHG,mBAIHe,QAAAA,SAAcf,GACdC,QAAQC,IAAAF,GACJS,EAAAA,WAAYT,KAAZA,GACAL,EAAE,WAAWqB,SACbrB,WAAA,WACAuB,EAAAA,WAAWC,UACPxB,EAAE,WAAWwB,KAAAA,KACbxB,QAjHhBA,EAAE0B,UAAUC,MAAM,WADd9B,IAAGC,EAAAA,OAAP8B,YACEF,OAAUC,IAAZE,EAAkB,eAAY,oBACtBA,aAAWD,kBAAf,EACA9B,OAAAA,aAAegC,qBAAe,EAC9BhC,OAAOiC,SACPjC,QAAOiC,IAAAA,OAAPC,SAAoBF,QAEpBhB,IAAAA,EAAQP,OAAI0B,SAAOD,OACnB,IAAA,GAAA9B,EAAAgC,QAAA,KAAA,CACIhC,IAAAA,EAAM+B,EAAOD,OAAP,GACN9B,EAAIgC,EAAAA,MAAJ,KACArC,GAAIsC,EAAAA,GACJA,WAAUC,OAAMvC,IAChBA,EAAAA,gBAAAwC,MAAAZ,oBAEAzB,EAAE,gBAAgBqC,MAAMZ,YAG3BzB,EAAA,iBAAAqC,MAAA,WAGGvC,OAAOa,IAAIC,KAAK","file":"write-4ce901fa26.js","sourcesContent":["/**\r\n * Created by Administrator on 2017/10/30.\r\n */\r\n\r\nvar id,editor;\r\n$(document).ready(function () {\r\n    var E = window.wangEditor;\r\n    editor = new E('#editor-tool','#editor-content');\r\n    editor.customConfig.pasteFilterStyle = false;\r\n    editor.customConfig.uploadImgShowBase64 = true ;  // 使用 base64 保存图片\r\n    editor.create();\r\n    console.log(window.location.search);\r\n    /*判断是写文章还是编辑*/\r\n    var url = window.location.search;\r\n    if (url.indexOf(\"?\") != -1) {\r\n        var str = url.substr(1);\r\n        str = str.split(\"=\");\r\n        id = str[1];\r\n        getArticle(editor,id);\r\n        $('#savePassage').click(updatePassage);\r\n    } else {\r\n        $('#savePassage').click(newPassage);\r\n    }\r\n\r\n    $('#clearPassage').click(function () {\r\n        editor.txt.html('');\r\n    });\r\n\r\n});\r\n\r\nfunction getArticle(editor,id) {\r\n    $.ajax({\r\n        url:'/admin/article/detail/'+id,\r\n        type:'GET',\r\n        dataType:'json',\r\n        success:function (data) {\r\n            if(data) {\r\n                console.log('receive data:');\r\n              /*  console.log(data);*/\r\n                $('#inputTitle').val(data.title);\r\n                $('#editor-des').val(data.abstract);\r\n                $('#select-box').val(data.category);\r\n                editor.txt.html(data.content);\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\nfunction newPassage() {\r\n        console.log(editor.txt.html());\r\n        var title = $('#inputTitle').val();\r\n        var category = $('#select-box').val();\r\n        var addCategory = $('#addCategory').val();\r\n        var abstract = $('#editor-des').val();\r\n        var content = editor.txt.html();\r\n\r\n        var data = {\r\n            title: title,\r\n            abstract:abstract,\r\n            content:content\r\n        };\r\n        if(addCategory) {\r\n            data['addCategory'] = addCategory;\r\n        } else {\r\n            data['category'] = category;\r\n        }\r\n        var dataSend = JSON.stringify(data);\r\n        console.log(dataSend);\r\n        $.ajax({\r\n            url:\"/admin/article/new\",\r\n            type:'POST',\r\n            data:dataSend,\r\n            contentType : 'application/json',\r\n            success:function (data) {\r\n                console.log(data);\r\n                $('#status').text(data);\r\n                $('#status').fadeIn();\r\n                setTimeout(function () {\r\n                    $('#status').fadeOut();\r\n                    $('#status').text('');\r\n                },3000);\r\n            }\r\n        });\r\n}\r\n\r\nfunction updatePassage() {\r\n    console.log('updatePassage');\r\n    console.log('id = ' + id);\r\n    var title = $('#inputTitle').val();\r\n    var category = $('#select-box').val();\r\n    var addCategory = $('#addCategory').val();\r\n    var abstract = $('#editor-des').val();\r\n    var content = editor.txt.html();\r\n\r\n    var data = {\r\n        id:id,\r\n        title: title,\r\n        abstract:abstract,\r\n        content:content\r\n    };\r\n    if(addCategory) {\r\n        data['addCategory'] = addCategory;\r\n    } else {\r\n        data['category'] = category;\r\n    }\r\n    var dataSend = JSON.stringify(data);\r\n    console.log(dataSend);\r\n    $.ajax({\r\n        url:\"/admin/article/update\",\r\n        type:'POST',\r\n        data:dataSend,\r\n        contentType : 'application/json',\r\n        success:function (data) {\r\n            console.log(data);\r\n            $('#status').text(data);\r\n            $('#status').fadeIn();\r\n            setTimeout(function () {\r\n                $('#status').fadeOut();\r\n                $('#status').text('');\r\n            },3000);\r\n        }\r\n    });\r\n}"]}